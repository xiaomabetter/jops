{% extends 'base/_modal.html' %}

{% block modal_class %}modal-lg{% endblock %}
{% block modal_id %}template_list_modal{% endblock %}
{% block modal_title%}模板列表{% endblock %}
{% block modal_body %}
<script src="{{ url_for('static', filename='js/jquery.form.min.js') }}"></script>
<style>
.modal-body {
    padding: 0px 0px 0px 0px;
}
.twoLine {
    max-width:300px;
    display:block;
    text-overflow:ellipsis;
    overflow:hidden;
    white-space:nowrap;
}
</style>
<div class="wrapper wrapper-content">
   <div class="row">
       <div class="col-lg-12 animated fadeInRight">
           <div class="mail-box-header">
               <div class="btn-group" style="float: left">
                   <select id="RegionId_select" class="form-control input-sm">
                    </select>
               </div>
               <div class="btn-group" style="float: left">
                    <select id="ZoneId_select" class="form-control input-sm">
                    </select>
               </div>
               <table class="table table-striped table-bordered table-hover" id="templates_list_table" style="width: 100%">
                     <thead>
                        <th class="text-center">
                            <input type="checkbox" class="ipt_check_all">
                        </th>
                        <th class="text-center">模板名称</th>
                        <th class="text-center">实例规格</th>
                        <th class="text-center">系统盘类型及大小</th>
                        <th class="text-center">网络类型</th>
                        <th class="text-center">可用区</th>
                    </thead>
               </table>
           </div>
       </div>
   </div>
</div>
<script src="{{ url_for('static', filename='js/plugins/select2/select2.full.min.js') }}"></script>
<script>
template_table = 0;
function Init_Template_url(){
    var init_template_url = "{{ url_for('assets-api.templates_api') }}";
    var regionid = $('#RegionId_select').val()
    if (regionid) {
        init_template_url = setUrlParam(init_template_url, "RegionId", regionid);
    }
    var Zoneid = $('#ZoneId_select').val()
    if (Zoneid) {
        init_template_url = setUrlParam(init_template_url, "Zoneid", Zoneid);
    }
    return init_template_url
}
function initTable() {
    init_template_url = Init_Template_url();
    var options = {
        ele: $('#templates_list_table'),
        buttons: [],
        columnDefs: [
        ],
        ajax_url: init_template_url,
        columns: [{data: "id" },{data: "name" },{data: "instance_type" }, {data: "SystemDiskCategorySize"},
                {data: "InstanceNetworkType"}, {data: "ZoneId"}],
        order: [],
        op_html: $('#actions').html()
    };
    template_table = jumpserver.initDataTable(options);
    return template_table
}

function ChangeSelect() {
    init_template_url = Init_Template_url();
    template_table.ajax.url(init_template_url);
    template_table.ajax.reload();
}

$(document).ready(function() {
    initTable()
}).on('change', '#RegionId_select', function () {
    ChangeSelect();
}).on('change', '#ZoneId_select', function () {
    ChangeSelect();
})

</script>
{% endblock %}

{% block modal_button %}
{% endblock %}
{% block modal_confirm_id %}btn_template_modal_confirm{% endblock %}
